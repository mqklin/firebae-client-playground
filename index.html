<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Firebae</title>
</head>
<body>
    Hello world
    <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase-messaging.js"></script>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyDiwMubHsvyd2L2NTOCnEzWM4NoGkHYeIo",
            authDomain: "fir-push-notificator-app.firebaseapp.com",
            databaseURL: "https://fir-push-notificator-app.firebaseio.com",
            projectId: "fir-push-notificator-app",
            storageBucket: "fir-push-notificator-app.appspot.com",
            messagingSenderId: "350318375239"
        };
        firebase.initializeApp(firebaseConfig);

        navigator.serviceWorker.register('./firebase-messaging-sw.js').then((registration) => {
            const messaging = firebase.messaging();
            messaging.useServiceWorker(registration);
            messaging.usePublicVapidKey("BO3GSworajFpWabmdQL5WO5jbwdWysRCAXNciS9MrqthVhpOtPPt5YrfAB9EK5_yPgqOqCgNdxqP-VK0ZfcO5WM");
            messaging.onMessage(function(payload) {
                console.log('Message received. ', payload);
            });
            messaging.requestPermission().then(function() {
                console.log('Notification permission granted.');
                messaging.getToken().then(function(currentToken) {
                    if (currentToken) {
                        console.log('Token', currentToken);
                    } else {
                        // Show permission request.
                        console.log('No Instance ID token available. Request permission to generate one.');
                        // Show permission UI.
                        console.log("Null token to server")
                    }
                }).catch(function(err) {
                    console.log('An error occurred while retrieving token. ', err);
                    console.log('Null token to server');
                });



                messaging.onTokenRefresh(function() {
                    messaging.getToken().then(function(refreshedToken) {
                        console.log('Token refreshed.');
                        // Indicate that the new Instance ID token has not yet been sent to the
                        // app server.
                        console.log('Refresh token', refreshedToken);
                        // ...
                    }).catch(function(err) {
                        console.log('Unable to retrieve refreshed token ', err);
                    });
                });



            }).catch(function(err) {
                console.log('Unable to get permission to notify.', err);
            });
        });
    </script>
</body>
</html>